use memmap::MmapMut;
use std::mem;

fn main() {
    let instructions: [u8; 44] = [
        0xe1, 0x45, 0x8c, 0xd2, 0x21, 0xcd, 0xad, 0xf2, 0xe1, 0x65, 0xce, 0xf2, 0x01, 0x0d, 0xe0,
        0xf2, 0xe1, 0x83, 0x1f, 0xf8, 0x01, 0x01, 0x80, 0xd2, 0xe0, 0x63, 0x21, 0xcb, 0xe1, 0x03,
        0x1f, 0xaa, 0xe2, 0x03, 0x1f, 0xaa, 0x70, 0x07, 0x80, 0xd2, 0xe1, 0x66, 0x02, 0xd4,
    ];
    let mut mmap = MmapMut::map_anon(instructions.len()).unwrap();
    mmap.copy_from_slice(&instructions);
    let mmap = mmap.make_exec().expect("make_exec");
    let f: extern "C" fn() -> u8 = unsafe { mem::transmute(mmap.as_ptr()) };
    f();
}
